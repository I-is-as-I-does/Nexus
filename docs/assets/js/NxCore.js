/*! Nexus | (c) 2021 I-is-as-I-does | AGPLv3 license */
"use strict";(self.webpackChunknexus=self.webpackChunknexus||[]).push([[424],{253:(n,e,t)=>{t.d(e,{x:()=>o,X:()=>d});var r,i,a=t(881),l=t(25),u=t(618);function o(n=null){if(r)(0,a.Pr)("Nexus | container already set");else{n||(n=l.cZ);var e={};(r=document.querySelector(n))?r.dataset&&(e=Object.assign(e,r.dataset)):(r=document.createElement("DIV"),document.body.append(r)),(0,u.Ov)(e),(i=document.createElement("DIV")).className="nx",r.append(i)}}function d(){return i||o(),i}},25:(n,e,t)=>{t.d(e,{cZ:()=>r,Je:()=>i,U:()=>a,zE:()=>l});const r="#Nexus",i="https://cdn.jsdelivr.net/gh/I-is-as-I-does/Nexus@latest/dist/js/NxIO.js",a="https://cdn.jsdelivr.net/gh/I-is-as-I-does/Nexus@latest/dist/css/NexusI.min.css",l={src:null,id:"/",style:a,lang:"en"}},618:(n,e,t)=>{t.d(e,{Ov:()=>s,pm:()=>f,Bq:()=>h});var r=t(368),i=t(753),a=t(75),l=t(451),u=t(25).zE,o=window.location.href,d=o.substring(0,o.lastIndexOf("/")+1),c=new URLSearchParams(window.location.search.slice(1));function s(n){(0,r.bT)(n)&&(["src","style"].forEach((e=>{!function(n,e){n.hasOwnProperty(e)&&n[e].length&&"http"!==n[e].substring(0,4)&&(n[e]=d+n[e])}(n,e)})),(0,i.HH)(n.src)&&(u.src=n.src,(0,l.Q0)(n.id)&&(u.id=n.id)),(0,i.HH)(n.style)&&(u.style=n.style),(0,r.fw)(n.lang)&&(u.lang=n.lang,(0,a.uM)(n.lang)))}function f(n){return c.has(n)}function h(n){return u[n]}},549:(n,e,t)=>{t.d(e,{e:()=>o,P:()=>d});var r=t(753),i=t(881),a=t(85),l=t(451);function u(n){n.index=[],n.threads.map((e=>{n.index.push(e.id)}))}function o(n){return n.target.files.length&&"application/json"==n.target.files[0].type?new Promise(((e,t)=>{var r=new FileReader;return r.onload=function(n){var r=function(n){var e=JSON.parse(n.target.result);return!(!e||!(e=(0,l.wJ)(e)))&&(u(e),e)}(n);r?e(r):t()},r.readAsText(n.target.files[0])})):Promise.reject()}function d(n){var e,t=(0,a.Yb)(n);return null!==t?Number.isInteger(t)?Promise.reject(t):Promise.resolve(t):(e=n,(0,r._l)(e).then((n=>((0,i.ab)(),(n=(0,l.wJ)(n))?(u(n),(0,a.pH)(e,n),n):((0,a.pH)(e,400),(0,i.Pr)((0,i.ah)()),(0,i.fZ)("Invalid source"),Promise.reject(400))))).catch((n=>{throw(0,i.Pr)(n),(0,a.pH)(e,404),(0,i.fZ)("No response"),404})))}document.cookie="Nx=Instance; SameSite=None; Secure"},869:(n,e,t)=>{t.r(e),t.d(e,{initPage:()=>s});var r=t(253),i=t(158),a=t(618),l=t(881),u=t(371),o=t(425),d=t(176),c=t(220);function s(n=null,e=null){return(0,r.x)(n),(0,a.Ov)(e),(0,a.pm)("log")&&(0,l.kb)(!0),(0,i.A)().then((()=>(0,a.Bq)("src")?(0,u.t$)((0,a.Bq)("src"),(0,a.Bq)("id")):{})).then((n=>{var e;n.srcData&&(0,u.rz)(n),e=(0,a.pm)("edit")?(0,d.N)(n):(0,c.D)(n),(0,r.X)().append((0,o.IW)(e))})).catch((n=>{(0,l.Pr)(n),(0,r.X)().append((0,o.ao)())}))}},158:(n,e,t)=>{t.d(e,{A:()=>o,o:()=>d});var r=t(753),i=t(881),a=t(618),l=t(25),u={};function o(n=null,e=".nx"){return n||(n=(0,a.Bq)("style")),(0,r.Yc)(e,n).then((()=>(u[n]=!0,!0))).catch((e=>{if((0,i.Pr)(e),(0,i.fZ)("Theme not found"),u[n]=!1,n!=l.U)return o(l.U);throw 404}))}function d(n=null){return n||(n=(0,a.Bq)("style")),u[n]}},881:(n,e,t)=>{t.d(e,{Pr:()=>l,kb:()=>u,ab:()=>o,fZ:()=>d,ah:()=>c});var r=t(368),i=[],a=!1;function l(n){a&&console.log(n)}function u(n=!0){a=n}function o(){i=[]}function d(n,e=null){var t={msg:n};(0,r.fw)(e)&&(t.detail=t),i.push(n)}function c(){return i}},371:(n,e,t)=>{t.d(e,{t$:()=>o,Ek:()=>d,f2:()=>c,Mq:()=>s,rz:()=>f,hb:()=>h});var r=t(549),i=t(85);var a={dataUrl:null,srcData:null,threadId:"/",threadIndex:-1},l={onChange:[],onSrcChange:[]},u=!1;function o(n,e){return(0,r.P)(n).then((t=>{var r={dataUrl:n,threadId:e,srcData:t,threadIndex:t.index.indexOf(e)};return-1===r.threadIndex&&"/"!==e&&(r.threadId="/"),r}))}function d(n,e=!1){var t="onChange";e&&(t="onSrcChange"),l[t].push(n)}function c(n,e=!1,t=!1){if(!u){var r=n.dataUrl!=a.dataUrl;if(t||r||n.threadId!=a.threadId)u=!0,e||(0,i.Dy)(a),a=n,o=["onChange"],(r||t)&&o.push("onSrcChange"),o.forEach((n=>{l[n].length&&l[n].forEach((n=>{n(a)}))})),setTimeout((function(){u=!1}),800)}var o}function s(){return a}function f(n){return!a.dataUrl&&(a=n,!0)}function h(){return 800}},85:(n,e,t)=>{t.d(e,{KR:()=>S,Yb:()=>w,Ih:()=>I,XU:()=>Z,VG:()=>O,of:()=>y,pH:()=>x,EW:()=>g,q1:()=>k,Dy:()=>b,eG:()=>U});var r=t(753),i=t(811);const a=(0,i.$o)(),l=(0,i.G)();function u(n){n&&!n.getItem("available")&&n.setItem("available",5e3)}function o(n){return"session"==n?l:a}function d(n,e,t="session",r=null,a=!0){r&&(r[n]=e);var l=o(t);if(null!=l){var u=(0,i.$w)(e,!0);if(u>2e3)return;var d=l.getItem("available");d<1e3&&(d=5e3-(0,i.hh)(l,2e3)),d-=u,a&&(e=JSON.stringify(e)),l.setItem(n,e),l.setItem("available",Math.ceil(d))}}function c(n,e="session",t=null,r=!0){if(null!==t&&t.hasOwnProperty(n))return t[n];var i=o(e);if(i){var a=i.getItem(n);if(a)return r&&(a=JSON.parse(a)),t&&(t[n]=a),a}return null}u(a),u(l);var s={},f={},h={},p={};const v="nx-edit#";function m(n){if(-1!=n.threadIndex&&n.srcData.threads[n.threadIndex]){var e=n.srcData.threads[n.threadIndex].content.timestamp;return new Date(e)}return null}function g(n,e){d(v+n,e,"local")}function I(n){return c(v+n,"local")}function b(n){var e=n.dataUrl+"#"+n.threadId;if(!s.hasOwnProperty(e)){var t=m(n);t&&d(e,t,"local",s,!1)}}function y(n){var e=function(n){var e=c(n.dataUrl+"#"+n.threadId,"local",s,!1);return e?new Date(e):null}(n);if(!e)return!0;var t=m(n);return!t||e==t}function x(n,e){d(n,e,"session",f)}function w(n){return c(n,"session",f)}function S(n){var e=c(n,"local",h,!1);return e||d(n,e=(0,r.AB)(n),"local",h,!1),e}function k(n,e){d(n,e,"local",p,!0)}function O(n){return c(n,"local",p,!0)}function U(n){d("nx-lang",n,"local",null,!1)}function Z(){return c("nx-lang","local",null,!1)}},75:(n,e,t)=>{t.d(e,{Ye:()=>f,VQ:()=>h,GY:()=>p,uM:()=>d,FC:()=>s});var r=t(368),i=t(85);var a={fr:{author:"auteur·e",handle:"pseudonyme",about:"à propos",url:"url",id:"id",title:"titre",description:"description",timestamp:"date",main:"corps",aside:"aparté",media:"média",type:"type",caption:"légende",index:"index",distant:"distant",local:"local",threads:"fils",linked:"liés",content:"contenu",history:"historique",copied:"copié",embed:"intégré",source:"source",saved:"sauvegardé","local thread":"fil local","linked threads":"fils liés","No valid thread":"Aucun fil valide","Duplicate thread id":"Identifiant du fil en double","Duplicate linked thread":"Fil lié en double","Invalid linked thread":"Fil lié non valide","Invalid url":"Url non valide","Invalid thread id":"Identifiant de fil non valide","Invalid length":"Longueur non valide","Invalid min length":"Longueur minimale non valide","Invalid max length":"Longueur maximale non valide","Unable to cut string":"Impossible de raccourcir le texte","Invalid timestamp":"Horodatage non valide","Unknown field":"Champ inconnu","Invalid field type":"Type de champ non valide","Field is empty":"Le champ est vide","Unable to extend string":"Impossible de prolonger le texte","Unknown characters limits category":"Catégorie de limite de caractères inconnue","Unknown items limits category":"Catégorie de limite d'éléments inconnue","Invalid media type":"Type de media non valide","Invalid app url":"Url de l'application non valide","Init failed":"L'initialisation a échoué","Theme not found":"Thème non trouvé","No response":"Aucune réponse","Invalid source":"Source non valide","Invalid Nexus data":"Données Nexus non valides"}},l=["en","fr"],u=(0,i.XU)();null==u||c(u)||(u=null,(0,i.eG)(null));var o=null;function d(n){u||s(n)}function c(n){return(0,r.fw)(n)&&l.includes(n)}function s(n){return!(!c(n)||n==o)&&(o=n,function(n){u!=n&&((0,i.eG)(n),u=n)}(n),!0)}function f(){return l}function h(){return o}function p(n){var e=n;return"en"!=o&&a[o][n]&&(e=a[o][n]),e}u?o=u:c(o=document.querySelector("html").lang)||(o="en")},142:(n,e,t)=>{t.d(e,{T:()=>u,w:()=>o});var r=t(75),i=t(931),a={};function l(n,e){(0,i.Po)(n,(0,r.GY)(e),50)}function u(n){if((0,r.FC)(n))for(let[n,e]of Object.entries(a))e.forEach((e=>{l(e,n)}))}function o(n,e){a[e]||(a[e]=[]),a[e].push(n)}},696:(n,e,t)=>{t.d(e,{Gd:()=>r,Ln:()=>i,m2:()=>a,SO:()=>l,WS:()=>u,og:()=>o,Q1:()=>d,bt:()=>c,Ni:()=>s});const r="https://nexus-dock.github.io/",i={data:"Object",nexus:"String",author:"Object",handle:"String",about:"String",url:"String",threads:"Array","threads.item":"Object",id:"String",title:"String",description:"String",content:"Object",timestamp:"String",main:"String",aside:"String",media:"Object",type:"String",caption:"String",linked:"Array","linked.item":"Object"},a={handle:[3,30],about:[0,400],title:[3,30],description:[0,400],main:[1,1e3],aside:[0,400],caption:[0,200]},l={threads:[1,100],linked:[0,100]},u=["page","video","image","audio","youtube","vimeo","soundcloud"],o="^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1])(T(0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]))?$",d="[a-zA-Z0-9-]{3,36}",c="(/|"+d+")",s="^https?://.*"},451:(n,e,t)=>{t.d(e,{Q0:()=>p,wJ:()=>I});var r=t(368),i=t(753),a=t(947),l=t(696),u=t(881);function o(n){return l.m2.hasOwnProperty(n)?l.m2[n]:((0,u.fZ)("Unknown characters limits category",n),!1)}function d(n){return l.SO.hasOwnProperty(n)?l.SO[n]:((0,u.fZ)("Unknown items limits category",n),!1)}function c(n,e){return s(n,e,!0)||(n=""),!function(n,e){var t=o(e);if(!1!==t){if(n.length>=t[0])return!0;(0,u.fZ)("Invalid min length",e)}return!1}(n,e)?n=function(n,e){var t=o(e);if(!1!==t){var r=t[0]-n.length;return r>0&&(n="-".repeat(r)+n),n}return(0,u.fZ)("Unable to extend string",e),null}(n,e):function(n,e){var t=o(e);if(!1!==t){if(n.length<=t[1])return!0;(0,u.fZ)("Invalid max length",e)}return!1}(n,e)||(n=function(n,e){var t=o(e);if(!1!==t)return(0,a.Oq)(n,t[1]);return(0,u.fZ)("Unable to cut string",e),""}(n,e)),n}function s(n,e,t=!0){if(l.Ln.hasOwnProperty(e)){var i=l.Ln[e];if(null!=n&&n.constructor.name==i){if(!t||!(0,r.xb)(n))return!0;(0,u.fZ)("Field is empty",e)}else(0,u.fZ)("Invalid field type",e)}else(0,u.fZ)("Unknown field",e);return!1}function f(n){return s(n,"media",!0)&&v(n.url)&&(s(e=n.type,"type",!0)&&l.WS.includes(e)||((0,u.fZ)("Invalid media type",type),0))?(n.caption=c(n.caption,"caption"),n):{url:"",type:"",caption:""};var e}function h(n){return s(n,"content",!0)&&function(n,e=!1){return!(!s(n,"timestamp",!0)||!(n.match(l.og)||!e&&(0,r.iX)(n)))||((0,u.fZ)("Invalid timestamp",n),!1)}(n.timestamp)&&s(n.main,"main",!0)&&(n.main=c(n.main,"main"),n.main)?(n.aside=c(n.aside,"aside"),n.media=f(n.media),n):null}function p(n,e=!1){var t;return t=e?l.bt:l.Q1,!(!s(n,"id",!0)||!n.match(t))||((0,u.fZ)("Invalid thread id",n),!1)}function v(n){return!!(0,i.HH)(n)||((0,u.fZ)("Invalid url",n),!1)}function m(n){return s(n,"threads.item",!0)&&p(n.id)&&(n.content=h(n.content),null!=n.content)?(n.title=c(n.title,"title"),n.description=c(n.description,"description"),n.linked=function(n){n.slice(0,d("linked")[1]);for(var e,t=[],r=0;r<n.length;r++){if(s(e=n[r],"linked.item",!0)&&v(e.url)&&p(e.id,!0)||((0,u.fZ)("Invalid linked thread"),0)){var i=n[r].url+" "+n[r].id;if(!t.includes(i)){t.push(i);continue}(0,u.fZ)("Duplicate linked thread",i)}n.splice(r,1)}return n.length&&n.sort(((n,e)=>n.url<e.url?1:-1)),n}(n.linked),n):null}function g(n){return function(n){return!(!v(n)||n!=l.Gd)||((0,u.fZ)("Invalid app url"),!1)}(n)||(n=l.Gd),n}function I(n){return s(n,"data",!0)&&(n.nexus=g(n.url),n.author=s(e=n.author,"author",!0)&&v(e.url)&&(e.handle=c(e.handle,"handle"),e.handle)?(e.about=c(e.about,"about"),e):null,n.author&&(n.threads=function(n){if(s(n,"threads",!0)){var e=[];n=n.slice(0,d("threads")[1]);for(var t=0;t<n.length;t++){if(n[t]=m(n[t]),null!=n[t]){if(!e.includes(n[t].id)){e.push(n[t].id);continue}(0,u.fZ)("Duplicate thread id",n[t].id)}n.splice(t,1)}if(n.length)return n}return(0,u.fZ)("No valid thread"),[]}(n.threads),n.threads.length))?n:null;var e}}}]);