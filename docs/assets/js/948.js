/*! For license information please see 948.js.LICENSE.txt */
"use strict";(self.webpackChunknexus=self.webpackChunknexus||[]).push([[948],{948:(t,e,n)=>{function r(t,e=200,n=null){p(t);let r=t.offsetHeight;t.style.overflow="hidden",t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0,t.style.marginTop=0,t.style.marginBottom=0,t.offsetHeight,t.style.boxSizing="border-box",t.style.transitionProperty="height, margin, padding",t.style.transitionDuration=e+"ms",t.style.height=r+"px",t.style.removeProperty("padding-top"),t.style.removeProperty("padding-bottom"),t.style.removeProperty("margin-top"),t.style.removeProperty("margin-bottom"),window.setTimeout((()=>{t.style.removeProperty("height"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property"),"function"==typeof n&&n()}),e)}function a(t,e=null){t.style.opacity=1,function n(){(t.style.opacity-=.1)<0?(t.style.display="none","function"==typeof e&&e()):requestAnimationFrame(n)}()}function i(t,e=null){t.style.opacity=0,p(t),function n(){var r=parseFloat(t.style.opacity);(r+=.1)>1?"function"==typeof e&&e():(t.style.opacity=r,requestAnimationFrame(n))}()}function o(t,e=200,n=null){a(t),function(t,e=200,n=null){t.style.transitionProperty="height, margin, padding",t.style.transitionDuration=e+"ms",t.style.boxSizing="border-box",t.style.height=t.offsetHeight+"px",t.offsetHeight,t.style.overflow="hidden",t.style.height=0,t.style.paddingTop=0,t.style.paddingBottom=0,t.style.marginTop=0,t.style.marginBottom=0,window.setTimeout((()=>{t.style.display="none",t.style.removeProperty("height"),t.style.removeProperty("padding-top"),t.style.removeProperty("padding-bottom"),t.style.removeProperty("margin-top"),t.style.removeProperty("margin-bottom"),t.style.removeProperty("overflow"),t.style.removeProperty("transition-duration"),t.style.removeProperty("transition-property"),"function"==typeof n&&n()}),e)}(t,e,n)}function l(t,e=200,n=null){t.style.opacity=0;var a=e-200;a<200&&(a=200),setTimeout((function(){i(t,n)}),a),r(t,e,n)}function d(t,e,n=20){var r,a,i,o=t.textContent.split(""),l=e.split(""),d=o.length,s=l.length;d>s?(r=d,a=0,i=function(){r>s?o.pop():o[r-1]=l[r-1],r--}):(r=0,a=s,i=function(){r<d?o[r]=l[r]:o.push(l[r]),r++});var u=setInterval((function(){i(),t.textContent=o.join(""),r==a&&clearInterval(u)}),n)}function s(t,e,n=!1,a=!0,i=200,o=null){var d,s;return e.style.display="none",a?(e.style.opacity=0,d=l):d=r,s=n?function(){t.prepend(e)}:function(){t.append(e)},c(t,e,s,(function(){d(e,i,o)}))}function u(t,e,n=null){e.style.opacity=0;var r=t.parentNode,o=t.offsetHeight,d=function(){t.replaceWith(e)},s=function(){var t=e.offsetHeight;!function(t,e,n,r=null){e===n?i(t,r):l(t,200,r)}(e,o,t,n)};a(t,(function(){c(r,e,d,s)}))}function c(t,e,n,r=null){t instanceof Element||(t=document.body);var a="m"+Math.random().toString(20).substr(2);return e.classList.add(a),new Promise((i=>{var o=new MutationObserver((()=>{t.querySelector("."+a)&&(e.classList.remove(a),o.disconnect(),"function"==typeof r&&r(),i(!0))}));o.observe(t,{childList:!0}),n()}))}function p(t){t.style.removeProperty("display");let e=window.getComputedStyle(t).display;"none"===e&&(e="block"),t.style.display=e}function f(){return v("localStorage")?localStorage:null}function h(t,e=!0){var n,r=(n=JSON.stringify(t),(new TextEncoder).encode(n).length);return e&&(r/=1e3),r}function v(t){var e;try{e=window[t];var n="__storage_test__";return e.setItem(n,n),e.removeItem(n),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&e&&0!==e.length}}n.r(e),n.d(e,{getCurrentState:()=>pe,init:()=>fe,registerTranslElm:()=>de,registerUpdateEvt:()=>se,triggerTranslate:()=>ce,triggerUpdate:()=>ue});var m={},y={},g=f(),x=v("sessionStorage")?sessionStorage:null;function I(t){t&&!t.getItem("available")&&t.setItem("available",5e3)}function b(t){if(-1!=t.threadIndex){var e=t.srcData.threads[t.threadIndex].record.timestamp;return new Date(e)}return null}function w(t,e,n){if(null!=t){var r=h(n,!0);if(r>2e3)return;var a=t.getItem("available");a<100&&function(t,e=null,n=2e3){null==e&&(e=h(t,!0));for(var r=0;r<t.length;r++){var a=t.key(r),i=h(t.getItem(a),!0);if(t.removeItem(a),(e+=i)>n)break}}(t,a,2e3),a-=r,t.setItem(e,JSON.stringify(n)),t.setItem("available",a)}}function k(t,e){y[t]=e,w(x,t,e)}function C(t,e){t.classList.contains("nx-on-display")?(t.classList.remove("nx-unseen"),t.lastChild.textContent=""):function(t){var e=function(t){var e,n=t.dataUrl+"#"+t.threadId;return m.hasOwnProperty(n)?e=m[n]:g&&(e=g.getItem(n)),e?new Date(e):null}(t);if(!e)return!0;var n=b(t);return!n||e==n}(e)&&(t.classList.add("nx-unseen"),t.lastChild.textContent="*")}function S(t,e,n,r){e==r.dataUrl&&n==r.threadId?t.classList.add("nx-on-display"):t.classList.remove("nx-on-display")}function D(t){var e="/";return"/"!=t.threadId&&(e=t.srcData.threads[t.threadIndex].name),e}function L(t,e=!1){var n=te("A","nx-view-link");return n.append(O(t,e)),n}function P(t,e,n){S(t,e,n,pe()),se((function(r){S(t,e,n,r)}))}function E(t,e=!1){var n=te("SPAN","nx-handle");return n.textContent=t.srcData.author.handle,e&&se((function(t){d(n,t.srcData.author.handle,20)}),!0),n}function N(t,e=!1){var n=te("A","nx-author-url nx-external-link");n.target="_blank",n.href=t.srcData.author.url;var r=[];["[","]"].forEach((t=>{var e=te("SPAN","nx-author-url-brackets");e.textContent=t,r.push(e)}));var a=te("SPAN");return a.textContent=t.srcData.author.miniUrl,n.append(r[0],a,r[1]),e&&se((function(t){n.href=t.srcData.author.url,d(a,t.srcData.author.miniUrl,20)}),!0),n}function O(t,e=!1){var n=te("SPAN","nx-thread-name");return n.textContent=D(t),e&&se((function(t){var e=D(t);d(n,e,15)})),n}function U(t,e=!1){var n=L(t,e);return"/"!=t.threadId&&(P(n,t.dataUrl,t.threadId),function(t,e){t.append(te("SPAN","nx-new-tag")),C(t,e),se((function(){C(t,e)}))}(n,t)),n.addEventListener("click",(()=>{ue(t)})),n}function A(t,e=!1){var n=te("A","nx-author-link");n.append(E(t,e));var r={dataUrl:t.dataUrl,srcData:t.srcData,threadId:"/",threadIndex:-1};return n.addEventListener("click",(function(){ue(r,"/")})),n}I(g),I(x);const j={src:null,id:"/",style:"https://cdn.jsdelivr.net/gh/I-is-as-I-does/Nexus-Prototype@0.2.0/cdn/css/NexusI.css",lang:"en",embed:!0,history:!1,log:!1},V={handle:[3,30],about:[0,400],name:[3,30],description:[0,400],main:[1,1e3],aside:[0,400],caption:[0,200]},T={threads:[1,100],linked:[0,100]},R=["page","video","image","audio","youtube","vimeo","soundcloud"],_={data:"Object",nexus:"String",author:"Object",handle:"String",about:"String",url:"String",threads:"Array","threads.item":"Object",id:"String",name:"String",description:"String",record:"Object",timestamp:"String",main:"String",aside:"String",media:"Object",type:"String",caption:"String",linked:"Array","linked.item":"Object"};var H=!1,q=null,F=null,M=1,B=1,z={"<":null,">":null};function J(){q.scrollIntoView({block:"end",behavior:"smooth"})}function G(){B>1?z["<"].classList.remove("nx-nav-end"):z["<"].classList.add("nx-nav-end"),B<M-1?z[">"].classList.remove("nx-nav-end"):z[">"].classList.add("nx-nav-end")}function Q(t){M++;var e=document.createElement("LI");return e.append(A(t,!1),N(t,!1),function(t){var e=L(t,!1);return P(e,t.dataUrl,t.threadId),e.addEventListener("click",(()=>{H=!0,ue(t,!0)})),e}(t)),e}function W(t){return function(t){q=te("UL","nx-history-list");var e=te("LI");e.textContent="...",q.append(e),q.append(Q(t)),(F=te("DIV","nx-history-drawer")).append(q),F.style.display="none",se((function(t){!function(t){if(!H){M>100&&(q.children[1].remove(),M--),B=M;var e=Q(t);s(q,e,!1,!0,200,(function(){J()})),G()}}(t)}))}(t),ee("history",null,[(n=te("DIV","nx-history-nav"),Object.keys(z).forEach((t=>{z[t]=te("A","nx-nav-end"),z[t].textContent=t,z[t].addEventListener("click",(function(){z[t].classList.contains("nx-nav-end")||("<"==t?B--:B++,G(),q.children[B].querySelector(".nx-thread-name").click())}))})),n.append(z["<"],((e=te("A","nx-history-toggle")).textContent="≚",e.addEventListener("click",(()=>{"≙"==e.textContent?(e.textContent="≚",e.classList.remove("nx-active"),o(F,200)):(e.textContent="≙",e.classList.add("nx-active"),l(F,200),J())})),e),z[">"]),n),F],!1);var e,n}function X(t){return("string"==typeof t||t instanceof String)&&t.length}const Z=f();var $={},K=["en"],Y=null,tt=null;function et(t){return X(t)&&K.includes(t)}function nt(t){return!(!et(t)||t==tt||(tt=t,function(t){Z&&Y!=t&&(Z.setItem("nx-lang",t),Y=t)}(t),0))}function rt(){return tt}function at(t){var e;return"en"!=tt&&(e=$[tt][t]),e||(e=t),e}!function(t){if(null!==(e=t)&&"Object"==e.constructor.name&&Object.keys(e).length)return Object.assign($,t),K.push(...Object.keys($).filter((t=>K.indexOf(t)<0))),!0;var e}({fr:{distant:"distant",local:"local",threads:"fils",thread:"fil",linked:"liés",record:"entrée",history:"historique",copied:"copié",embed:"intégré",source:"source",log:"journal","Nexus not found":"Nexus inconnu","Nexus theme not found":"Thème du Nexus inconnu","Invalid Nexus data":"Données Nexus invalides","No valid thread":"Aucun fil valide","Duplicate thread id":"Identifiant du fil en double","Duplicate linked thread":"Fil lié en double","Invalid linked thread":"Fil lié non valide","Invalid url":"Url non valide","Invalid thread id":"Identifiant de fil non valide","Invalid length":"Longueur non valide","Invalid min length":"Longueur minimal non valide","Invalid max length":"Longueur maximal non valide","Unable to cut string":"Impossible de raccourcir le texte","Invalid timestamp":"Date non valide","Unknown field":"Champ inconnu","Invalid field type":"Type de champ non valide","Field is empty":"Le champ est vide","Unable to extend string":"Impossible de prolonger le texte","Unknown characters limits category":"Catégorie de limite de caractères inconnue","Unknown items limits category":"Catégorie de limite d'éléments inconnue","Invalid media type":"Type de media non valide"}}),Z&&(et(Y=Z.getItem("nx-lang"))||(Y=null,Z.removeItem("nx-lang"))),function(){if(Y)tt=Y;else{var t=document.querySelector("html").lang;et(t)||(t="en"),tt=t}}();var it=null;function ot(t,e){var n=te("A","nx-source-"+t);return n.textContent=e,n}function lt(t){return'{"url": "'+t.dataUrl+'", "threadId": "'+t.threadId+'"}'}function dt(t,e){var n=te("TEXTAREA");return n.spellcheck=!1,n.textContent=e(t),se((function(t){n.textContent=e(t)})),n}function st(t){var e,n,r=ot("copy","⧉"),o=(e="copied",(n=te("SPAN","nx-source-copy-tooltip")).textContent=e,n.style.opacity=0,n.hidden=!0,de(n,e),n);return r.append(o),r.addEventListener("click",(()=>{return e=t.textContent,n=()=>{!function(t,e=200,n=null){var r=[a,i];(function(t){if(!t)return!1;do{if(t instanceof Element){if(t.hidden||!t.offsetHeight)return!0;var e=window.getComputedStyle(t);if("0"==e.width||"0"==e.height||"0"==e.opacity||"none"==e.display||"hidden"==e.visibility)return!0}}while(t=t.parentNode);return!1})(t)&&r.reverse(),r[0](t,(function(){"function"==typeof n&&n(),window.setTimeout((()=>{r[1](t)}),e)}))}(o,1e3)},void navigator.clipboard.writeText(e).then((()=>n()));var e,n})),r}function ut(t,e){var n=te("DIV","nx-"+t+"-snippet");return n.append(e,st(e)),n}function ct(t){return'<div id="Nexus" data-src="'+t.dataUrl+'" data-id="'+t.threadId+'" data-style="'+j.style+'" data-lang="'+rt()+'" data-embed="'+j.embed+'" data-history="'+j.history+'"></div>\r\n<script src="https://cdn.jsdelivr.net/gh/I-is-as-I-does/Nexus-Prototype@0.2.0/cdn/js/NxViewerIO.js"><\/script>'}function pt(t){return ee("source",null,function(t){(it=te("DIV","nx-source-drawer")).append(function(t){return ut("json",dt(t,lt))}(t),function(t){return ut("embed",dt(t,ct))}(t)),it.style.display="none";var e,n,r=te("DIV","nx-source-toggle"),a=(e="< />",(n=ot("snippets","</>")).addEventListener("click",(()=>{n.textContent==e?(n.textContent="</>",n.classList.remove("nx-active"),o(it,100)):(n.textContent=e,n.classList.add("nx-active"),l(it,100,(function(){it.scrollIntoView({block:"end",behavior:"smooth",inline:"nearest"})})))})),n);return r.append(a),[r,it]}(t),!1)}function ft(){var t="nx-selected-lang",e=te("SPAN","nx-lang-list-toggle");e.textContent=rt();var n=te("UL","nx-lang-list");K.forEach((r=>{var a=te("LI");a.textContent=r,r==e.textContent&&a.classList.add(t),a.addEventListener("click",(()=>{var r=a.textContent;r!=rt()&&(n.querySelector("."+t).classList.remove(t),a.classList.add(t),d(e,r,50),ce(r)),n.style.display="none"})),n.append(a)})),n.style.display="none";var r=te("DIV","nx-lang-switch");return r.append(e,n),e.addEventListener("click",(()=>{var t="none";n.style.display==t&&(t="block"),n.style.display=t})),r}function ht(t){let e;try{e=new URL(t)}catch(t){return!1}return"http:"===e.protocol||"https:"===e.protocol}function vt(t){return fetch(t,{method:"GET",credentials:"include"}).then((t=>t.json()))}function mt(t){return t.split(/[\\/]/).pop()}function yt(t,e=!0){var n=t.replace(/^(https?:\/\/)?/,"").split("/");if(t=n[0],e&&n.length>1){n.length>2&&(t+="/...");var r=n.pop();r.length>18&&(r="..."+r.substr(-15)),t+="/"+r}return t}var gt=[];function xt(t,e=null){var n={msg:t};X(e)&&(n.detail=e),gt.push(n)}function It(t){return V.hasOwnProperty(t)?V[t]:(xt("Unknown characters limits category",t),!1)}function bt(t){return T.hasOwnProperty(t)?T[t]:(xt("Unknown items limits category",t),!1)}function wt(t,e){return kt(t,e,!0)||(t=""),function(t,e){var n=It(e);if(!1!==n){if(t.length>=n[0])return!0;xt("Invalid min length",e)}return!1}(t,e)?function(t,e){var n=It(e);if(!1!==n){if(t.length<=n[1])return!0;xt("Invalid max length",e)}return!1}(t,e)||(t=function(t,e){var n,r,a=It(e);return!1!==a?(n=t,r=a[1],n.length>r&&(n=n.substr(0,r-5)+"(...)"),n):(xt("Unable to cut string",e),"")}(t,e)):t=function(t,e){var n=It(e);if(!1!==n){var r=n[0]-t.length;return r>0&&(t="-".repeat(r)+t),t}return xt("Unable to extend string",e),null}(t,e),t}function kt(t,e,n=!0){if(_.hasOwnProperty(e)){var r=_[e];if(null!=t&&t.constructor.name==r){if(!n||!("object"==typeof(a=t)?!Object.keys(a).length:!a||!a.length))return!0;xt("Field is empty",e)}else xt("Invalid field type",e)}else xt("Unknown field",e);var a;return!1}function Ct(t){return!(!kt(t,"id",!0)||!t.match("[a-zA-Z0-9-]{3,36}"))||(xt("Invalid thread id",t),!1)}function St(t){return!!ht(t)||(xt("Invalid url",t),!1)}function Dt(t){return kt(t,"threads.item",!0)&&Ct(t.id)&&(t.record=kt(i=t.record,"record",!0)&&(kt(r=i.timestamp,"timestamp",!0)&&(r.match("^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1]) (0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])$")||X(a=r)&&!isNaN(new Date(a)))||(xt("Invalid timestamp",r),0))&&kt(i.main,"main",!0)&&(i.main=wt(i.main,"main"),i.main)?(i.aside=wt(i.aside,"aside"),i.media=kt(e=i.media,"media",!0)&&St(e.url)&&(kt(n=e.type,"type",!0)&&R.includes(n)||(xt("Invalid media type",type),0))?(e.caption=wt(e.caption,"caption"),e):{url:"",type:"",caption:""},i):null,null!=t.record)?(t.name=wt(t.name,"name"),t.description=wt(t.description,"description"),t.linked=function(t){t=t.slice(0,bt("linked")[1]);for(var e,n=[],r=0;r<t.length;r++){if(kt(e=t[r],"linked.item",!0)&&St(e.url)&&Ct(e.id)||(xt("Invalid linked thread"),0)){var a=t[r].url+" "+t[r].id;if(!n.includes(a)){n.push(a);continue}xt("Duplicate linked thread",a)}t.splice(r,1)}return t.length&&t.sort(((t,e)=>t.url<e.url?1:-1)),t}(t.linked),t):null;var e,n,r,a,i}var Lt=j,Pt=null;(Pt=document.querySelector("#Nexus"))?(ht(Pt.dataset.src)&&(Lt.src=Pt.dataset.src,Ct(Pt.dataset.id)&&(Lt.id=Pt.dataset.id)),ht(Pt.dataset.style)&&(Lt.style=Pt.dataset.style),X(Pt.dataset.lang)&&(Lt.lang=Pt.dataset.lang),"false"==Pt.dataset.embed&&(Lt.embed=!1),"true"==Pt.dataset.history&&(Lt.history=!0),"true"==Pt.dataset.log&&(Lt.log=!0)):(Pt=document.createElement("DIV"),document.body.append(Pt)),Lt.embed?(Pt.classList.add("nexus"),Pt=Pt.attachShadow({mode:"open"})):document.querySelector("html").classList.add("nexus");var Et,Nt,Ot,Ut,At=null;function jt(t){var e=function(t){if(y.hasOwnProperty(t))return y[t];if(x){var e=x.getItem(t);if(e)return JSON.parse(e)}return!1}(t);return!1!==e?Number.isInteger(e)?Promise.reject(e):Promise.resolve(e):function(t){return vt(t).then((e=>{if(e=function(t){return kt(t,"data",!0)&&St(t.nexus)&&(t.author=kt(e=t.author,"author",!0)&&St(e.url)&&(e.handle=wt(e.handle,"handle"),e.handle)?(e.about=wt(e.about,"about"),e):null,t.author&&(t.threads=function(t){if(kt(t,"threads",!0)){var e=[];t=t.slice(0,bt("threads")[1]);for(var n=0;n<t.length;n++){if(t[n]=Dt(t[n]),null!=t[n]){if(!e.includes(t[n].id)){e.push(t[n].id);continue}xt("Duplicate thread id",t[n].id)}t.splice(n,1)}if(t.length)return t}return xt("No valid thread"),[]}(t.threads),t.threads.length))?t:null;var e}(e))return function(t){t.index=[],t.threads.map((e=>{t.index.push(e.id)})),t.author.miniUrl=function(t){for(var e=t.replace(/^(https?:\/\/)?(www.)?/,"").split(":")[0].split("/")[0].split("."),n=0;n<e.length;n++)if(e[n].includes("-"))e[n]=e[n].split("-").map((t=>t[0])).join("-");else{for(var r=e[n].split(""),a=0,i=0;i<r.length;i++)["a","e","i","o","u","y"].includes(r[i])&&(0!==a&&i!==a+1?r[i]="":a=i);e[n]=r.join("")}return e.join(".")}(t.author.url)}(e),k(t,e),e;throw k(t,400),Tt(gt),At="invalid data",400}))}(t).catch((e=>{Tt(e),k(t,404),At="no response"}))}function Vt(){var t,e;return document.cookie="Nx=Instance; SameSite=None; Secure",Lt.lang&&(t=Lt.lang,Y||nt(t)),(Lt.src?(Lt.style,e=null,Lt.embed&&(e=Pt),function(t,e,n=null){return n||!function(t,e){if(document.styleSheets.length)for(var n=mt(e),r=0;r<document.styleSheets.length;r++){var a=document.styleSheets[r].href;if(a){if(a==e||mt(a)==n)return!0;if(a.startsWith(window.location.origin)){var i=document.styleSheets[r].cssRules;for(let e=0;e<i.length;e++)if(i[e].selectorText==t)return!0}}}return!1}(t,e)?new Promise(((t,r)=>{var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.onload=t,a.onerror=r,a.href=e,n?n.append(a):document.head.append(a)})):Promise.resolve(!0)}(".nexus",Lt.style,e).catch((t=>{Tt(t),At="theme not found"}))).then((()=>Rt(Lt.src,Lt.id))):Promise.reject(422)).catch((t=>{!function(t){Tt(t),At||(At="init failed"),Pt.append(function(t){var e=document.createElement("P");e.classList.add("nx-error");var n=document.createElement("SPAN");n.textContent="—/ — ";var r=document.createElement("SPAN");return r.textContent=at(t),e.append(n,r),e}(At))}(t)}))}function Tt(t){!1!==Lt.log&&console.log(t)}function Rt(t,e){return jt(t).then((n=>{var r={dataUrl:t,threadId:e,srcData:n,threadIndex:n.index.indexOf(e)};return-1===r.threadIndex&&"/"!==e&&(r.threadId="/"),r}))}function _t(t){var e=te("DIV","nx-boken-media");return e.append(function(t){var e=te("A","nx-external-link");return e.target="_blank",e.href=t,e.textContent=yt(t,!0),e}(t)),e}function Ht(t){var e=te("A","nx-external-link");return e.href=t,e.target="_blank",e.textContent=yt(t,!0),e}function qt(t){var e=te("VIDEO");e.setAttribute("controls",!0);var n=te("SOURCE");return n.src=t,e.append(n),n.onerror=()=>{u(e,_t(t))},e}function Ft(t){var e=te("AUDIO");return e.setAttribute("controls",!0),e.src=t,e.onerror=()=>{u(e,_t(t))},e}function Mt(t){var e=te("IMG");return e.src=t,e.onerror=()=>{u(e,_t(t))},e}function Bt(t){var e=te("DIV","nx-record-media");return Et=te("DIV"),function(t){t&&t.record.media.type&&function(t,e,n=null){var r,a={page:Ht,image:Mt,video:qt,audio:Ft},i=function(e){Et.className="nx-"+t+"-media",n?u(n,e):s(Et,e,!1,!0,200)};a.hasOwnProperty(t)?i(a[t](e)):(r=function(t,e,n=null,r=null){e=e.toLowerCase();var a={youtube:"https://youtube.com/oembed?url=",vimeo:"https://vimeo.com/api/oembed.json?url=",soundcloud:"https://soundcloud.com/oembed?format=json&url="};return!!a.hasOwnProperty(e)&&(t=a[e]+encodeURIComponent(t),null!=n&&(t+="&maxwidth="+n),null!=r&&(t+="&maxheight="+r),t)}(e,t,360),vt(r).then((t=>{if(t&&t.hasOwnProperty("html")){var e=t.html.split('src="')[1].split('"')[0],n=document.createElement("IFRAME");return n.width=t.width,n.height=t.height,n.frameborder="no",n.scrolling="no",n.allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",n.allowfullscreen=!0,n.title=t.title,n.src=e,n}throw"invalid oembed response"}))).then((t=>{i(t)})).catch((t=>{Tt(t),i(_t(e))}))}(t.record.media.type,t.record.media.url)}(t),e.append(Et,function(t){return Xt(t,["record","media","caption"])}(t)),e}function zt(t){var e=null;return"/"!=t.threadId&&(e=t.srcData.threads[t.threadIndex]),e}function Jt(t){return(Nt=te("DIV")).append(...Qt(t)),ee("distant",null,[Nt],!0)}function Gt(t,e){var n=O(t,!0);return function(t){(Ot=te("DIV","nx-thread-description")).append(Xt(t,["description"]))}(e),function(t){(Ut=te("DIV","nx-local-record")).append(Wt(t))}(e),ee("local",[n],[Ot,Ut],!0)}function Qt(t){var e=[];null!=t&&(e=t.linked);var n=te("UL","nx-distant-records"),r=te("UL","nx-distant-indexes");if(e.length){var a=[];e.forEach((t=>{Rt(t.url,t.id).then((t=>{var e,i=[A(t,!1),N(t,!1),U(t,!1)];"/"==t.threadId?a.includes(t.threadId)||(a.push(t.threadId),(e=te("LI")).append(...i),s(r,e,!1,!1,200)):((e=te("LI")).append(...i),e.append(Wt(zt(t))),s(n,e,!1,!1,200))}))}))}else{var i=te("LI");i.textContent="...",n.append(i)}return[n,r]}function Wt(t){var e=te("DIV","nx-record");return e.append(function(t){var e=te("DIV","nx-record-meta"),n=Xt(t,["record","timestamp"]);return e.append(n),e}(t),function(t){var e=te("DIV","nx-record-body");return e.append(Xt(t,["record","main"]),Xt(t,["record","aside"])),e}(t),Bt(t)),e}function Xt(t,e){var n=te("P","nx-"+e.join("-"));return n.textContent=function(t,e=[]){if(t){for(var n=Object.assign({},t),r=0;r<e.length;r++)n=n[e[r]];if(X(n))return n}return""}(t,e),n}var Zt=null;function $t(t){var e=te("DIV","nx-about-author");return e.append(Kt(t)),se((function(t){u(e.firstChild,Kt(t))}),!0),e}function Kt(t){var e=te("P");return e.textContent=t.srcData.author.about,e}function Yt(t,e,n){var r=Object.assign({},t);r.threadId=e,r.threadIndex=n;var a=te("LI");return a.append(U(r,!1)),a}function te(t,e){var n=document.createElement(t);return e&&(n.className=e),n}function ee(t,e=null,n=null,r=!1){var a,i,o=te("SECTION","nx-"+t+"  nx-block");if(r&&o.append(((i=te("SPAN","nx-landmark nx-landmark-"+(a=t))).textContent=at(a),de(i,a),i)),e){var l=te("HEADER");l.append(...e),o.append(l)}return n&&o.append(...n),o}function ne(t){var e=te("DIV");e.append(function(t){return function(t){Zt=te("UL");var e=t.srcData.index;if(e.length)for(var n=0;n<e.length;n++)Zt.append(Yt(t,e[n],n));se((function(t){!function(t){var e=Zt.childNodes,n=t.srcData.index,r=n.length,a=e.length,i=0;if(a)for(var l=function(t){o(t,200,(function(){t.remove()}))},d=0;d<a;d++)if(r>d){var c=Yt(t,n[d],d);u(e[d],c),i++}else l(e[d]);if(i<r)for(var p=i;p<r;p++)s(Zt,Yt(t,n[p],p),!1,!0,200)}(t)}),!0)}(t),ee("index",[E(t,!0),N(t,!0)],[$t(t),Zt],!0)}(t));var n,r=te("DIV");return r.append(...function(t){var e=zt(t),n=[Gt(t,e),Jt(e)];return se((function(t){!function(t){var e=zt(t),n=Wt(e),r=Xt(e,["description"]);u(Ot.firstChild,r),u(Ut.firstChild,n);var a=Qt(e);Array.from(Nt.childNodes).forEach(((t,e)=>{u(t,a[e])}))}(t)})),n}(t)),function(t,e,n){var r=te("DIV","nx-instance"),a=te("HEADER");a.append(...t);var i=te("MAIN");i.append(...e);var o=te("FOOTER");return o.append(...n),r.append(a,i,o),r}([ee("app",null,[(n=te("A","nx-app-link nx-external-link"),n.target="_blank",n.href="https://github.com/I-is-as-I-does/Nexus-Prototype",n.title="Nexus",n.textContent="Nexus",n),ft()],!1),W(t)],[e,r],[pt(t)])}var re={dataUrl:null,srcData:null,threadId:"/",threadIndex:-1},ae={},ie={onChange:[],onSrcChange:[]},oe=!1;function le(t,e){d(t,at(e),50)}function de(t,e){ae[e]||(ae[e]=[]),ae[e].push(t)}function se(t,e=!1){var n="onChange";e&&(n="onSrcChange"),ie[n].push(t)}function ue(t,e=!1){if(!oe){var n=t.dataUrl!=re.dataUrl;(n||t.threadId!=re.threadId)&&(oe=!0,e||(function(t){var e=t.dataUrl+"#"+t.threadId;if(!m.hasOwnProperty(e)){var n=b(t);n&&(m[e]=n,w(g,e,n))}}(re),Lt.history&&(r={id:re.threadId,src:re.dataUrl},history.replaceState(r,""),history.pushState(r,""))),re=t,function(t){var e=["onChange"];t&&e.push("onSrcChange"),e.forEach((t=>{ie[t].length&&ie[t].forEach((t=>{t(re)}))}))}(n),function(){setTimeout(function(){oe=!1}.bind(this),800)}())}var r}function ce(t){if(nt(t))for(let[t,e]of Object.entries(ae))e.forEach((e=>{le(e,t)}))}function pe(){return re}function fe(t=null){Vt().then((e=>{re=e,Pt.append(ne(e)),"function"==typeof t&&t(e),Lt.history&&(window.onpopstate=t=>{t.state&&t.state.src&&t.state.id&&ue(t.state.src,t.state.id)})}))}}}]);