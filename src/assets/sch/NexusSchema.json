{
  "$schema": "http://json-schema.org/draft-07/schema",
  "type": "object",
  "required": [
      "nexus",
      "author",
      "threads"
  ],
  "properties": {
      "nexus": {
          "$id": "#/properties/nexus",
          "type": "string",
          "pattern":"^https?:\/\/"
      },
      "author": {
          "$id": "#/properties/author",
          "type": "object",
          "required": [
              "handle",
              "url"
          ],
          "properties": {
              "handle": {
                  "$id": "#/properties/author/properties/handle",
                  "type": "string",
                  "maxLength":30
              },
              "about": {
                  "$id": "#/properties/author/properties/about",
                  "type": "string",
                  "maxLength":400
              },
              "url": {
                  "$id": "#/properties/author/properties/url",
                  "type": "string",
                  "pattern":"^https?:\/\/"
              }
          },
          "additionalProperties": false
      },
      "threads": {
          "$id": "#/properties/threads",
          "type": "array",
          "uniqueItems": true,
          "additionalItems": true,
          "items": {
              "$id": "#/properties/threads/items",
              "anyOf": [
                  {
                      "$id": "#/properties/threads/items/anyOf/0",
                      "type": "object",
                      "required": [
                          "id",
                          "name",
                          "record"
                      ],
                      "properties": {
                          "id": {
                              "$id": "#/properties/threads/items/anyOf/0/properties/id",
                              "type": "string",
                              "pattern": "[a-zA-Z0-9-]{3,36}"
                          },
                          "name": {
                              "$id": "#/properties/threads/items/anyOf/0/properties/name",
                              "type": "string",
                              "minLength":3,
                              "maxLength":30
                          },
                          "description": {
                              "$id": "#/properties/threads/items/anyOf/0/properties/description",
                              "type": "string",
                              "maxLength":400
                          },
                          "record": {
                              "$id": "#/properties/threads/items/anyOf/0/properties/record",
                              "type": "object",
                              "required": [
                                  "timestamp",
                                  "main"
                              ],
                              "properties": {
                                  "timestamp": {
                                      "$id": "#/properties/threads/items/anyOf/0/properties/record/properties/timestamp",
                                      "type": "string",
                                      "pattern":"^[0-9]{4}-(0[1-9]|1[0-2])-(0[1-9]|[1-2][0-9]|3[0-1]) (0[0-9]|1[0-9]|2[0-3]):([0-5][0-9]):([0-5][0-9])$"
                                  },
                                  "main": {
                                      "$id": "#/properties/threads/items/anyOf/0/properties/record/properties/main",
                                      "type": "string",
                                      "maxLength":1000,
                                      "minLength":1
                                  },
                                  "aside": {
                                      "$id": "#/properties/threads/items/anyOf/0/properties/record/properties/aside",
                                      "type": "string",
                                      "maxLength":400
                                  },
                                  "media": {
                                      "$id": "#/properties/threads/items/anyOf/0/properties/record/properties/media",
                                      "type": "object",
                                      "required": [
                                          "url",
                                          "type"
                                      ],
                                      "properties": {
                                          "url": {
                                              "$id": "#/properties/threads/items/anyOf/0/properties/record/properties/media/properties/url",
                                              "type": "string",
                                              "pattern":"^https?:\/\/"
                                          },
                                          "type": {
                                              "$id": "#/properties/threads/items/anyOf/0/properties/record/properties/media/properties/type",
                                              "type": "string",
                                              "enum":["page","video","image","audio","youtube","vimeo","soundcloud"]
                                          },
                                          "caption": {
                                              "$id": "#/properties/threads/items/anyOf/0/properties/record/properties/media/properties/caption",
                                              "type": "string",
                                              "maxLength":1000
                                          }
                                      },
                                      "additionalProperties": false
                                  }
                              },
                              "additionalProperties": false
                          },
                          "linked": {
                              "$id": "#/properties/threads/items/anyOf/0/properties/linked",
                              "type": "array",
                              "uniqueItems": true,
                              "additionalItems": true,
                              "items": {
                                  "$id": "#/properties/threads/items/anyOf/0/properties/linked/items",
                                  "anyOf": [
                                      {
                                          "$id": "#/properties/threads/items/anyOf/0/properties/linked/items/anyOf/0",
                                          "type": "object",
                                          "required": [
                                              "url",
                                              "id"
                                          ],
                                          "properties": {
                                              "url": {
                                                  "$id": "#/properties/threads/items/anyOf/0/properties/linked/items/anyOf/0/properties/url",
                                                  "type": "string",
                                                  "pattern":"^https?:\/\/"
                                              },
                                              "id": {
                                                  "$id": "#/properties/threads/items/anyOf/0/properties/linked/items/anyOf/0/properties/id",
                                                  "type": "string",
                                                  "pattern": "[a-zA-Z0-9-]{3,36}"
                                              }
                                          },
                                          "additionalProperties": false
                                      }
                                  ]
                              }
                          }
                      },
                      "additionalProperties": false
                  }
              ]
          }
      }
  },
  "additionalProperties": false
}